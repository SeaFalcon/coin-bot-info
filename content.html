<!DOCTYPE html>
<html>
<head>
	<title id="Gazua">Gazua</title>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>

	<nav>
    <div class="nav-wrapper">
      <a href="#!" class="brand-logo">코인 봇 정보</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
      <!-- <ul class="right hide-on-med-and-down">
        <li><a href="sass.html">Sass</a></li>
        <li><a href="badges.html">Components</a></li>
        <li><a href="collapsible.html">Javascript</a></li>
        <li><a href="mobile.html">Mobile</a></li>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <li><a href="sass.html">Sass</a></li>
        <li><a href="badges.html">Components</a></li>
        <li><a href="collapsible.html">Javascript</a></li>
        <li><a href="mobile.html">Mobile</a></li>
      </ul> -->
    </div>
  </nav>
   
  <div class="card">
	  <div class="card-content">
	    <p>12.26 입출금관련 공지사항</p>
	  </div>
	  <div class="card-tabs">
	    <ul class="tabs tabs-fixed-width">
	      <li class="tab"><a class="active" href="#test4">이슈사항</a></li>
	      <li class="tab"><a href="#test5">입금 및 출금</a></li>
	      <li class="tab"><a href="#test7">수수료</a></li>
	    </ul>
	  </div>
	  <div class="card-content grey lighten-4">
	    <div id="test4">
	       - 매주 목요일 봇 정산시 지분 재산정 <br>
				 - 입금시 리플로 입금 원칙 고수(입금완료시 즉시 판매하여 원화로 지분 반영) <br>
				 - 매주 추가 입금 최소 100만원 ~ 1500만원 <br>
				 - 출금시엔 모든 원화 출금 가능(출금 단위 최소 10만원) <br>
				   -> 지분을 남길경우 최소 100만원 지분 보유 or 전액 출금 <br><br>
				 - 입금 신청자 최종 입금 완료 시 그 이후 봇 가동 <br>
				 - 입금 및 출금 신청시간 준수 <br>
				 - 건의사항은 단톡방 문의 및 알고계신 번호로 문의 <br><br>
				※ 입금 지갑주소는 문자&이메일로 목요일 PM5:00 ~ PM7:00에 알려 드립니다. ※ <br>
			</div>
	    <div id="test5">
	    	 - 신청시간 : 매주 수요일 ~ 매주 목요일 오후 2시 <br>
				 - 일시 : 매주 목요일 (변동사항 있을시 사전공지) <br>
				 - 봇 정산 시간 : PM5:00 ~ PM7:00 <br>
				  <br>
				 - 출금 <br>
				   출금시간 : PM7:00 ~ PM8:00 <br>
				     <br>
				 - 입금 <br>
				   입금시간(신규/추가입금) : PM8:00 ~ PM9:00 <br>
				 <br>
				 <br>
				＆출금양식 (메일문의 : coindori271@gmail.com) <br>
				   1. 제목 : [출금신청] <br>
				   2. 카톡 닉네임 / 이름 <br>
				   3. 환급 받을 금액(KRW) <br>
				   4. 환급 받을 코인종류 (BTC, ETH, ETC, LTC, XRP, DASH, BCH) <br>
				   5. 환급 받을 코인 지갑 주소 (여러번 확인 후 전송 부탁 드립니다.) <br>
				 <br>
				 <br>
				＆입금양식 (메일문의 : coindori271@gmail.com) <br>
				   1. 제목 : [입금신청] <br>
				   2. 카톡 닉네임 / 이름 <br>
				   3. 핸드폰 번호 <br>
				   4. 입금 예정인 KRW (입금 시간에 맞춰 구매 후 입금) <br>
				      -> 인수과정에서 소량의 금액 변동이 있을수 있습니다. <br>
				   ※ 입금 완료 후 반드시 거래번호 문자 or E-mail 로 전송 부탁드립니다. <br>
				           -> 미전송시 확인이 어렵습니다. <br>
				 <br>
	    </div>
	    <div id="test7">
	    	- 매주 정산일에 맞춰 20%의 수수료는 공제하여 기말자산을 평가.(차주의 기초자산)<br>
				- 정산 시 수수료가 3%미만일때는 수수료를 공제하지 않습니다.<br>
			  - 원금의 손실에 대해서는 책임지지 않습니다.<br>
	    </div>
	  </div>
	</div>

 <div class="row">
    <div class="col s12 m5">
      <div class="card-panel teal" style="background-color: #ee6e73;">
        <span class="white-text">
        	<span id="startKRW"></span><br>
        	<span id="totalKRW"></span><br>
        	<span id="profitKRW"></span><br>
        	<span id="profitPercent"></span><br>
        	<span id="profitfees"></span><br>
        	<span id="realProfit"></span><br>
        	<span id="realProfitPercent"></span><br>
			<span id="mine"></span><br>
			<span id="mineP"></span><br>
			<span id="mineM"></span><br>
			<span id="medi" style="font-size: 50;"></span><br>
			<span id="rail-btc" style="font-size: 50;"></span><br>
			<span id="ignis-btc" style="font-size: 50;"></span><br>
        </span>
      </div>
    </div>
  </div>


<div class="row">
	<form class="col s12">
	  <div class="row">    
		  <div class="input-field col s6">
		    <i class="material-icons prefix">attach_money</i>
		    <input id="don" type="number" class="validate">
		    <label for="don">자신의 지분(%)을 입력하세요</label>
		  </div>
		  <button class="waves-effect waves-light btn" id="btn" type="button">계산</button><br>
		</div>
	</form>
</div>

<!-- <div class="row">
  <div class="col s12 m6">
    <div class="card-panel teal" style="background-color: #ee6e73;">
      <span class="white-text">
      	<span id="serviceKRW"></span><br>
      	<span id="useKRW"></span><br>
      	<span id="BTC"></span><br>
      	<span id="ETH"></span><br>
      	<span id="BCH"></span><br>
      	<span id="DASH"></span><br>
      	<span id="ETC"></span><br>
      	<span id="LTC"></span><br>
      	<span id="QTUM"></span><br>
		<span id="XMR"></span><br>
		<span id="ZEC"></span><br>
		<span id="ALL"></span><br>
      </span>
    </div>
  </div>
</div> -->

<table class="highlight centered striped bordered responsive-table">
  <thead>
    <tr>
        <th>사용가능 금액</th>
        <th>예약매수 금액</th>
        <th>총 매수금액</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td id="avail"></td>
      <td id="order"></td>
      <td id="totalA"></td>
    </tr>
  </tbody>
</table><br><br>

<!-- bordered -->
<table class="highlight centered striped responsive-table">
  <thead>
    <tr>
        <th>코인명</th>
        <th>시장가(빗썸)</th>
        <th>수량</th>
        <th>총액</th>
    </tr>
  </thead>

  <tbody id="table"></tbody>
</table><br><br>

<div class="row">
	<form class="col s12">
	  <div class="row">    
		  <div class="input-field col s6">
		    <i class="material-icons prefix">attach_money</i>
		    <input id="nick" type="text" class="validate">
		    <label for="nick">자신의 닉네임을 입력하세요</label>
		  </div>
		  <button class="waves-effect waves-light btn" id="nickBtn" type="button">선택</button>
		  <button class="waves-effect waves-light btn" id="spread" type="button">전체보기</button><br>
		</div>
	</form>
</div>

<table class="highlight centered striped">
  <thead>
    <tr>
        <th>닉네임</th>
        <th>기초자산</th>
        <th>지분</th>
        <th>수익</th>
        <th>총 평가금액</th>
    </tr>
  </thead>

  <tbody id="share"></tbody>
</table>

<script type="text/javascript">

	var startKRW;
	var totalKRW;
	var profitKRW;
	var profitPercent;
	var fees;
	var realProfit;
	var realProfitPercent;
	var url = "http://211.238.145.76:3333/";
	var userObj = {};

	function repeat(){
		$.get(url, function(krwInfo) {
		  startKRW = krwInfo.startKRW;
		  totalKRW = krwInfo.totalKRW;
		  profitKRW = krwInfo.totalKRW - krwInfo.startKRW;
		  profitPercent = krwInfo.profitPercent;
		  fees = krwInfo.fees;
		  realProfit = krwInfo.realProfit;
		  realProfitPercent = krwInfo.realProfitPercent;
		  
		  $("#startKRW").html(`시작금액: ${numberWithCommas(krwInfo.startKRW)}원`);
		  $("#totalKRW").html(`현재금액: ${numberWithCommas(krwInfo.totalKRW)}원`);
		  $("#profitKRW").html(`수익금: ${numberWithCommas(krwInfo.profitKRW)}원`);
		  $("#profitPercent").html(`총 수익률: ${krwInfo.profitPercent}%`);
		  $("#profitfees").html(`수수료: ${numberWithCommas(krwInfo.fees)}원`);
		  $("#realProfit").html(`실수익금: ${numberWithCommas(krwInfo.realProfit)}원`);
		  $("#realProfitPercent").html(`실수익률: ${krwInfo.realProfitPercent}%`);

		  let myPercentage = 0.07218;
		 //  $.get("https://api.coinrail.co.kr/public/last/order?currency=med-btc", (med) =>{
			// 	$.get("https://api.coinrail.co.kr/public/last/order?currency=btc-krw", (btc) =>{
			// 		// console.log(btc.last_price, med.last_price, btc.last_price * med.last_price, "40376\n", 
			// 		// 	"medi:" + numberWithCommas(parseInt(40376.3583 * btc.last_price * med.last_price)) + "원 " + realProfitPercent + "/12.356(" + krwInfo.objective + ")",
			// 		// 	"\ns:" + numberWithCommas(parseInt(myPercentage * startKRW)), 
			// 		// 	"\nl:" + numberWithCommas(parseInt((realProfitPercent * 0.01 + 1) * myPercentage * startKRW)));

			// 		if(!med.error_code){
			// 			$('#medi').html("무인도 메디: " + med.last_price + " 사토시 (" + (btc.last_price * med.last_price).toFixed(4)  + "원)")
			// 			$('#rail-btc').html("무인도 비트: " + numberWithCommas(Number(btc.last_price)) + " 원")
			// 		}else{
			// 			$('#medi').html("힘내라 봇 가즈아! ㄱㄱ")
			// 			$('#rail-btc').html("코인레일 API 쥬금 으앙 ㅠㅠ")
			// 		}
			// 	});
			// });

			// $.get("http://211.238.145.76:3000", (data) => {
			// 	$('#ignis-btc').html(`이그니스: $${data[0]} USD /  ${data[1]}사토시`);
			// });
			$.get("https://api.upbit.com/v1/ticker?markets=KRW-BTC", (data) => {
				console.log(data);
				$('#rail-btc').html(`UpBit KRW-BTC: ${numberWithCommas(data[0].trade_price)} 원`);
			});

			$.get("https://api.upbit.com/v1/ticker?markets=KRW-EOS", (data) => {
				console.log(data);
				$('#ignis-btc').html(`UpBit KRW-EOS: ${numberWithCommas(data[0].trade_price)} 원`);
			});

			$.ajax({
				type: 'GET',
				url: "proxy/coindori/BotUserInfo.php",
				async: false,
				success: function(data){
					var obj = JSON.parse(data);
					if(obj.result === "0000"){
						userObj = obj;
						obj.total = obj.data.reduce((preV, curV, curIdx, array) => { return preV + Number(curV.base); }, 0);
					}else{
						alert("유저정보를 받아오는데 실패했습니다.")
					}	
				}
			})

			var bithumb = "https://api.bithumb.com/public/ticker/all";

			var people = {
				 "coinInfos" : [
				  	 {coin: "BTC", market: krwInfo.BTC/krwInfo.BTC_VOL, 
				  	 quantity: krwInfo.BTC_VOL, price: krwInfo.BTC},
				  	 {coin: "ETH", market: krwInfo.ETH/krwInfo.ETH_VOL, 
				  	 quantity: krwInfo.ETH_VOL, price: krwInfo.ETH},
				  	 {coin: "BCH", market: krwInfo.BCH/krwInfo.BCH_VOL, 
				  	 quantity: krwInfo.BCH_VOL, price: krwInfo.BCH},
				  	 {coin: "DASH", market: krwInfo.DASH/krwInfo.DASH_VOL, 
				  	 quantity: krwInfo.DASH_VOL, price: krwInfo.DASH},
				  	 {coin: "ETC", market: krwInfo.ETC/krwInfo.ETC_VOL, 
				  	 quantity: krwInfo.ETC_VOL, price: krwInfo.ETC},
				  	 {coin: "LTC", market: krwInfo.LTC/krwInfo.LTC_VOL, 
				  	 quantity: krwInfo.LTC_VOL, price: krwInfo.LTC},
				  	 {coin: "QTUM", market: krwInfo.QTUM/krwInfo.QTUM_VOL, 
				  	 quantity: krwInfo.QTUM_VOL, price: krwInfo.QTUM},
				  	 {coin: "XMR", market: krwInfo.XMR/krwInfo.XMR_VOL, 
				  	 quantity: krwInfo.XMR_VOL, price: krwInfo.XMR},
				  	 {coin: "ZEC", market: krwInfo.ZEC/krwInfo.ZEC_VOL, 
				  	 quantity: krwInfo.ZEC_VOL, price: krwInfo.ZEC},
				  	 {coin: "EOS", market: krwInfo.EOS/krwInfo.EOS_VOL, 
				  	 quantity: krwInfo.EOS_VOL, price: krwInfo.EOS},
				  	 {coin: "TOTAL", market: "-", 
				  	 quantity: "-", price: krwInfo.buyAmount},
				 ]
				}; 
			people.coinInfos.sort((a, b)=> {return a.price < b.price});

			var inHTML = "";

			$.each(people.coinInfos, function(index, value){
				if(value.quantity!=0 && value.price!=0 && value.quantity > 0.001 || typeof value.quantity === "string"){
			    var newItem = `
			    	<tr>
			    		<td>${value.coin}</td>
			    		<td>${value.market=="-" ? "-" : numberWithCommas(parseInt(value.market))}</td>
			    		<td>${value.quantity}</td>
			    		<td>${typeof value.price!=="string" ? numberWithCommas(parseInt(value.price)) : value.price}원</td>
			    	</tr>`
			    inHTML += newItem;
			  }
			});

			$("#table").html(inHTML);
			inHTML = "";

			$.each(userObj.data, function(index, value){
			    var newItem = `
			    	<tr id="${value.name}">
			    		<td>${value.name}</td>
			    		<td>${numberWithCommas(value.base)}원</td>
			    		<td>${(value.base/userObj.total*100).toFixed(3)}%</td>
			    		<td>${numberWithCommas(Math.round(value.base * (realProfitPercent * 0.01 + 1) - value.base))}원</td>
			    		<td>${numberWithCommas(Math.round(value.base * (realProfitPercent * 0.01 + 1)))}원</td>
			    	</tr>`
			    inHTML += newItem;
			});

			$("#share").html(inHTML);
			var nick = localStorage.getItem('nick');
			if($("#share").data('show') != undefined){
				$("#share").children().hide();
				$(`#share #${$("#share").data('show')}`).show();
			}else if(nick != undefined){
				$('#share').children().hide();
				$(`#share #${nick}`).show();
			}


		  $("#serviceKRW").html(`사용가능 금액: ${numberWithCommas(krwInfo.serviceKRW)}원`);
		  $("#useKRW").html(`매수주문 금액: ${numberWithCommas(krwInfo.useKRW)}원`);
			$("#BTC").html(`비트코인: ${numberWithCommas(parseInt(krwInfo.BTC))}원 / ${krwInfo.BTC_VOL}개`);
			//$("#BTC_VOL").html(`${krwInfo.BTC_VOL}개`);
			$("#ETH").html(`이더리움: ${numberWithCommas(parseInt(krwInfo.ETH))}원 / ${krwInfo.ETH_VOL}개`);
			//$("#ETH_VOL").html(`${krwInfo.ETH_VOL}`);
			$("#BCH").html(`비트코인캐시: ${numberWithCommas(parseInt(krwInfo.BCH))}원 / ${krwInfo.BCH_VOL}개`);
			//$("#BCH_VOL").html(`${krwInfo.BCH_VOL}`);
			$("#DASH").html(`대시: ${numberWithCommas(parseInt(krwInfo.DASH))}원 / ${krwInfo.DASH_VOL}개`);
			//$("#DASH_VOL").html(`${krwInfo.DASH_VOL}`);
			$("#ETC").html(`이더리움클래식: ${numberWithCommas(parseInt(krwInfo.ETC))}원 / ${krwInfo.ETC_VOL}개`);
			//$("#ETC_VOL").html(`${krwInfo.ETC_VOL}`);
			$("#LTC").html(`라이트코인: ${numberWithCommas(parseInt(krwInfo.LTC))}원 / ${krwInfo.LTC_VOL}개`);
			//$("#LTC_VOL").html(`${krwInfo.LTC_VOL}`);
			$("#QTUM").html(`퀀텀: ${numberWithCommas(parseInt(krwInfo.QTUM))}원 / ${krwInfo.QTUM_VOL}개`);
			//$("#QTUM_VOL").html(`${krwInfo.QTUM_VOL}`);
			$("#XMR").html(`모네로: ${numberWithCommas(parseInt(krwInfo.XMR))}원 / ${krwInfo.XMR_VOL}개`);
			//$("#XMR_VOL").html(`${krwInfo.XMR_VOL}`);
			$("#ZEC").html(`제트캐시: ${numberWithCommas(parseInt(krwInfo.ZEC))}원 / ${krwInfo.ZEC_VOL}개`);
			//$("#ZEC_VOL").html(`${krwInfo.ZEC_VOL}`);
			$("#ALL").html(`총 매수금액: ${numberWithCommas(parseInt(krwInfo.BTC + krwInfo.ETH + krwInfo.BCH + krwInfo.DASH + krwInfo.ETC + krwInfo.LTC + krwInfo.QTUM + krwInfo.XMR + krwInfo.ZEC))}원`);
			$("#Gazua").html(`${profitPercent}(${realProfitPercent})%/${numberWithCommas(krwInfo.serviceKRW)}원`);

			$("#avail").html(`${numberWithCommas(krwInfo.serviceKRW)}원`);
		  $("#order").html(`${numberWithCommas(krwInfo.useKRW)}원`);
		  $("#totalA").html(`${krwInfo.buyAmount}원`);
		});
	}
	repeat();
	setInterval(repeat, 10000);

	function numberWithCommas(x) {
		if(x >= 0){
    	return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }else{
    	return "-" + Math.abs(x).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
	}

	$('#btn').click(cal);

	function cal(){
		var myShare;
		myShare = $('#don').val() == "" ? localStorage.getItem('myShare') : $('#don').val()
		localStorage.setItem("myShare", myShare);
		var startTemp = parseInt( (startKRW * (myShare * 0.01) + 1) );
		var lastTemp = parseInt(( startKRW * (myShare * 0.01) + 1) 
			* (realProfitPercent * 0.01 + 1) );
		//console.log(startTemp, lastTemp);
		if(myShare){
			$('#mine').html("(내)시작금액  : " + numberWithCommas(startTemp) + "원" );
			$('#mineP').html("(내)최종금액  : " + numberWithCommas(lastTemp) + "원" );
			$('#mineM').html("(내)최종수익  : " + numberWithCommas(lastTemp - startTemp) + "원" );
		}
	}
	setInterval(cal, 5000);

	$('#nickBtn').click(() => {
		var nick = $('#nick').val();
		if(nick != ''){
			$('#share').children().hide();
			$(`#share #${nick}`).show();
			localStorage.setItem('nick', nick);
			$(`#share`).data("show", nick);
		}
	});

	$('#spread').click(() => {
		$('#share').children().show();
		localStorage.removeItem('nick');
	});

	/*function numberWithCommas(num){
	    var len, point, str; 
	       
	    num = num + ""; 
	    point = num.length % 3 ;
	    len = num.length; 
	   
	    str = num.substring(0, point); 
	    while (point < len) { 
	        if (str != "") str += ","; 
	        str += num.substring(point, point + 3); 
	        point += 3; 
	    } 
	    return str;
	}*/
</script>
</body>
</html>

<!-- <div id="result">
<p style="color: #FFB4B4">
	1~5%
</p>
<p style="color: #FF7E7E">
	5~10%
</p>
<p style="color: #FF4848">
	10~20%
</p>
<p style="color: #FF2424">
	20~30%
</p> -->